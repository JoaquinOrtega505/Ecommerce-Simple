<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Panel del Emprendedor</h1>
  </div>

  <div *ngIf="loading" class="loading">
    <p>Cargando estadÃ­sticas...</p>
  </div>

  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <div *ngIf="estadisticas && !loading" class="dashboard-content">
    <!-- InformaciÃ³n de la tienda -->
    <div class="tienda-info">
      <img *ngIf="estadisticas.tienda.logoUrl" [src]="estadisticas.tienda.logoUrl" alt="Logo" class="tienda-logo">
      <div>
        <h2>{{ estadisticas.tienda.nombre }}</h2>
        <a [href]="'https://' + estadisticas.tienda.subdominio + '.tudominio.com'" target="_blank" class="subdominio">
          {{ estadisticas.tienda.subdominio }}.tudominio.com
        </a>
      </div>
    </div>

    <!-- Tarjetas de estadÃ­sticas -->
    <div class="stats-grid">
      <!-- Productos -->
      <div class="stat-card" (click)="navegarAProductos()">
        <div class="stat-header">
          <h3>Productos</h3>
          <span class="stat-icon">ðŸ“¦</span>
        </div>
        <p class="stat-value">{{ estadisticas.productos.total }} / {{ estadisticas.productos.maximo }}</p>
        <div class="stat-details">
          <span class="detail-item">
            <strong>Disponibles:</strong> {{ estadisticas.productos.disponibles }}
          </span>
          <span class="detail-item warning" *ngIf="estadisticas.productos.stockBajo > 0">
            <strong>Stock bajo:</strong> {{ estadisticas.productos.stockBajo }}
          </span>
        </div>
      </div>

      <!-- Pedidos -->
      <div class="stat-card" (click)="navegarAPedidos()">
        <div class="stat-header">
          <h3>Pedidos</h3>
          <span class="stat-icon">ðŸ›’</span>
        </div>
        <p class="stat-value">{{ estadisticas.pedidos.total }}</p>
        <div class="stat-details">
          <span class="detail-item">
            <strong>Pendientes:</strong> {{ estadisticas.pedidos.pendientes }}
          </span>
          <span class="detail-item success">
            <strong>Completados:</strong> {{ estadisticas.pedidos.completados }}
          </span>
        </div>
      </div>

      <!-- Ventas Totales -->
      <div class="stat-card">
        <div class="stat-header">
          <h3>Ventas Totales</h3>
          <span class="stat-icon">ðŸ’°</span>
        </div>
        <p class="stat-value">${{ estadisticas.ventas.totales | number:'1.2-2' }}</p>
        <div class="stat-details">
          <span class="detail-item">
            <strong>Este mes:</strong> ${{ estadisticas.ventas.delMes | number:'1.2-2' }}
          </span>
        </div>
      </div>
    </div>

    <!-- Pedidos Recientes -->
    <div class="section-card">
      <div class="section-header">
        <h3>Pedidos Recientes</h3>
        <button class="btn-secondary" (click)="navegarAPedidos()">Ver todos</button>
      </div>
      <div class="pedidos-list" *ngIf="estadisticas.pedidosRecientes.length > 0; else noPedidos">
        <div class="pedido-item" *ngFor="let pedido of estadisticas.pedidosRecientes">
          <div class="pedido-info">
            <span class="pedido-id">#{{ pedido.id }}</span>
            <span class="pedido-cliente">{{ pedido.cliente }}</span>
          </div>
          <div class="pedido-details">
            <span class="pedido-estado" [ngClass]="'estado-' + pedido.estado.toLowerCase()">
              {{ pedido.estado }}
            </span>
            <span class="pedido-total">${{ pedido.total | number:'1.2-2' }}</span>
            <span class="pedido-fecha">{{ pedido.fechaCreacion | date:'short' }}</span>
          </div>
        </div>
      </div>
      <ng-template #noPedidos>
        <p class="no-data">No hay pedidos recientes</p>
      </ng-template>
    </div>

    <!-- Productos MÃ¡s Vendidos -->
    <div class="section-card">
      <div class="section-header">
        <h3>Productos MÃ¡s Vendidos</h3>
      </div>
      <div class="productos-list" *ngIf="estadisticas.productosMasVendidos.length > 0; else noProductos">
        <div class="producto-item" *ngFor="let producto of estadisticas.productosMasVendidos">
          <span class="producto-nombre">{{ producto.nombre }}</span>
          <span class="producto-cantidad">{{ producto.cantidadVendida }} vendidos</span>
        </div>
      </div>
      <ng-template #noProductos>
        <p class="no-data">No hay productos vendidos aÃºn</p>
      </ng-template>
    </div>
  </div>
</div>
